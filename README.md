# ytdl-core
*Fast & Reliable YouTube video downloader for Node.js*

[![npm version](https://img.shields.io/npm/v/ytdl-core.svg)](https://www.npmjs.com/package/ytdl-core)
[![npm downloads](https://img.shields.io/npm/dm/ytdl-core.svg)](https://www.npmjs.com/package/ytdl-core)
[![Node.js CI](https://github.com/fent/node-ytdl-core/workflows/Node.js%20CI/badge.svg)](https://github.com/fent/node-ytdl-core/actions)
[![codecov](https://codecov.io/gh/fent/node-ytdl-core/branch/master/graph/badge.svg)](https://codecov.io/gh/fent/node-ytdl-core)

**üöÄ NEW in v4.12.0:** Fast Android client optimization with **17% speed boost**!

---

## English | [Ti·∫øng Vi·ªát](#ti·∫øng-vi·ªát)

Yet another YouTube downloading module for Node.js. Written with only pure JavaScript and a node-friendly streaming interface.

### ‚ö° Performance Improvements
- **17% faster downloads** with Android client optimization
- Connection pooling with Keep-Alive for better throughput  
- Automatic server speed selection
- Direct URLs without signature decryption overhead

## üöÄ Quick Start

```bash
npm install ytdl-core
```

```js
const fs = require('fs');
const ytdl = require('ytdl-core');

// Download a video
ytdl('https://www.youtube.com/watch?v=dQw4w9WgXcQ')
  .pipe(fs.createWriteStream('video.mp4'));
```

## üìã Basic Examples

### Download Video
```js
const ytdl = require('ytdl-core');
const fs = require('fs');

// Simple download
ytdl('https://youtu.be/dQw4w9WgXcQ', { quality: 'highest' })
  .pipe(fs.createWriteStream('my-video.mp4'));
```

### Download Audio Only
```js
ytdl('https://youtu.be/dQw4w9WgXcQ', { 
  filter: 'audioonly',
  quality: 'highestaudio' 
})
.pipe(fs.createWriteStream('audio.mp3'));
```

### Get Video Info
```js
const info = await ytdl.getInfo('https://youtu.be/dQw4w9WgXcQ');
console.log('Title:', info.videoDetails.title);
console.log('Duration:', info.videoDetails.lengthSeconds, 'seconds');
console.log('Views:', info.videoDetails.viewCount);
```

### Download with Progress
```js
const stream = ytdl('https://youtu.be/dQw4w9WgXcQ');

stream.on('progress', (chunkLength, downloaded, total) => {
  const percent = (downloaded / total * 100).toFixed(1);
  console.log(`Downloaded: ${percent}%`);
});

stream.pipe(fs.createWriteStream('video.mp4'));
```

### Choose Format
```js
const info = await ytdl.getInfo('https://youtu.be/dQw4w9WgXcQ');
const format = ytdl.chooseFormat(info.formats, { 
  quality: '720p',
  filter: 'videoandaudio' 
});

console.log('Selected format:', format.qualityLabel);
ytdl.downloadFromInfo(info, { format }).pipe(fs.createWriteStream('720p.mp4'));
```

## üéõÔ∏è Advanced Usage

### Fast Mode (NEW!)
```js
// Fast mode enabled by default in v4.12.0
const stream = ytdl(url, { fastMode: true }); // 17% faster!

// Disable if needed
const stream = ytdl(url, { fastMode: false });
```

### Custom Quality Selection
```js
// Get best video quality
ytdl(url, { filter: 'videoandaudio', quality: 'highest' })

// Get smallest file size
ytdl(url, { filter: 'videoandaudio', quality: 'lowest' })

// Specific quality
ytdl(url, { filter: format => format.qualityLabel === '720p' })
```

### Download Range
```js
// Download first 10MB of video
ytdl(url, { 
  range: { start: 0, end: 10 * 1024 * 1024 } 
})
```

### Live Stream
```js
// Download live stream
ytdl(liveUrl, { 
  begin: Date.now(),
  liveBuffer: 20000 
})
```

## üìä API Reference

### ytdl(url, [options])

Downloads video from YouTube URL and returns a readable stream.

**Parameters:**
- `url` (string): YouTube video URL
- `options` (object): Download options

**Options:**
- `quality`: Video quality ('highest', 'lowest', specific quality)
- `filter`: Format filter ('audioandvideo', 'audioonly', 'videoonly') 
- `format`: Specific format object
- `range`: Byte range `{start: number, end: number}`
- `begin`: Start time (for live videos)
- `fastMode`: Enable Android client optimization (default: true)

### ytdl.getInfo(url, [options])

Gets video information without downloading.

```js
const info = await ytdl.getInfo('video_url');
console.log(info.videoDetails.title);
console.log(info.formats); // Available formats
```

### ytdl.getBasicInfo(url, [options])

Gets basic video information (faster).

### ytdl.chooseFormat(formats, options)

Chooses best format from available formats.

### Static Methods

```js
ytdl.validateID('dQw4w9WgXcQ')        // Validate video ID
ytdl.validateURL(url)                 // Validate YouTube URL  
ytdl.getVideoID(url)                  // Extract video ID
ytdl.getURLVideoID(url)              // Get video ID from URL
```

## üîß Advanced Examples

### Express.js Integration
```js
const express = require('express');
const ytdl = require('ytdl-core');
const app = express();

app.get('/download/:videoID', async (req, res) => {
  try {
    const { videoID } = req.params;
    const info = await ytdl.getInfo(videoID);
    
    res.header('Content-Disposition', `attachment; filename="${info.videoDetails.title}.mp4"`);
    ytdl(videoID, { quality: 'highest' }).pipe(res);
    
  } catch (error) {
    res.status(500).send('Download failed');
  }
});
```

### Batch Download
```js
const videos = [
  'https://youtu.be/dQw4w9WgXcQ',
  'https://youtu.be/9bZkp7q19f0'
];

for (const url of videos) {
  const info = await ytdl.getInfo(url);
  const filename = info.videoDetails.title.replace(/[^\w\s]/gi, '') + '.mp4';
  
  ytdl(url, { quality: 'highest' })
    .pipe(fs.createWriteStream(filename));
}
```

### TypeScript Support
```typescript
import ytdl from 'ytdl-core';

interface DownloadOptions {
  quality: string;
  filter: string;
}

const downloadVideo = async (url: string, options: DownloadOptions) => {
  const info = await ytdl.getInfo(url);
  const format = ytdl.chooseFormat(info.formats, options);
  
  return ytdl.downloadFromInfo(info, { format });
};
```

## üöÄ Performance Tips

1. **Use Fast Mode** (enabled by default): 17% speed improvement
2. **Connection Pooling**: Reuses HTTP connections for better performance
3. **Choose Appropriate Quality**: Lower quality = faster downloads
4. **Use `getBasicInfo()`**: Faster than `getInfo()` for basic details

## üêõ Error Handling

```js
const stream = ytdl(url);

stream.on('error', (error) => {
  if (error.statusCode === 410) {
    console.log('Video is age-restricted or unavailable');
  } else {
    console.log('Download error:', error.message);
  }
});
```

## üì± Limitations

- Private videos require authentication
- Age-restricted videos may need additional handling  
- Live streams have limited format options
- Some videos may be geo-blocked

## ü§ù Contributing

We welcome contributions! Please read our contributing guidelines and submit pull requests.

## üìÑ License

MIT License - see LICENSE file for details.

---

# Ti·∫øng Vi·ªát

*Module t·∫£i video YouTube nhanh v√† tin c·∫≠y cho Node.js*

## üöÄ B·∫Øt ƒë·∫ßu nhanh

```bash
npm install ytdl-core
```

```js
const fs = require('fs');
const ytdl = require('ytdl-core');

// T·∫£i video
ytdl('https://www.youtube.com/watch?v=dQw4w9WgXcQ')
  .pipe(fs.createWriteStream('video.mp4'));
```

## üìã V√≠ d·ª• c∆° b·∫£n

### T·∫£i video
```js
const ytdl = require('ytdl-core');
const fs = require('fs');

// T·∫£i video ch·∫•t l∆∞·ª£ng cao nh·∫•t
ytdl('https://youtu.be/dQw4w9WgXcQ', { quality: 'highest' })
  .pipe(fs.createWriteStream('video-cua-toi.mp4'));
```

### Ch·ªâ t·∫£i √¢m thanh
```js
ytdl('https://youtu.be/dQw4w9WgXcQ', { 
  filter: 'audioonly',
  quality: 'highestaudio' 
})
.pipe(fs.createWriteStream('nhac.mp3'));
```

### L·∫•y th√¥ng tin video
```js
const info = await ytdl.getInfo('https://youtu.be/dQw4w9WgXcQ');
console.log('Ti√™u ƒë·ªÅ:', info.videoDetails.title);
console.log('Th·ªùi l∆∞·ª£ng:', info.videoDetails.lengthSeconds, 'gi√¢y');
console.log('L∆∞·ª£t xem:', info.videoDetails.viewCount);
```

### T·∫£i v·ªõi thanh ti·∫øn tr√¨nh
```js
const stream = ytdl('https://youtu.be/dQw4w9WgXcQ');

stream.on('progress', (chunkLength, downloaded, total) => {
  const percent = (downloaded / total * 100).toFixed(1);
  console.log(`ƒê√£ t·∫£i: ${percent}%`);
});

stream.pipe(fs.createWriteStream('video.mp4'));
```

## ‚ö° T√≠nh nƒÉng m·ªõi - Ch·∫ø ƒë·ªô nhanh

```js
// Ch·∫ø ƒë·ªô nhanh ƒë∆∞·ª£c b·∫≠t m·∫∑c ƒë·ªãnh (nhanh h∆°n 17%!)
const stream = ytdl(url, { fastMode: true });

// T·∫Øt ch·∫ø ƒë·ªô nhanh n·∫øu c·∫ßn
const stream = ytdl(url, { fastMode: false });
```

## üéõÔ∏è S·ª≠ d·ª•ng n√¢ng cao

### Ch·ªçn ch·∫•t l∆∞·ª£ng t√πy ch·ªânh
```js
// Ch·∫•t l∆∞·ª£ng video t·ªët nh·∫•t
ytdl(url, { filter: 'videoandaudio', quality: 'highest' })

// File nh·ªè nh·∫•t
ytdl(url, { filter: 'videoandaudio', quality: 'lowest' })

// Ch·∫•t l∆∞·ª£ng c·ª• th·ªÉ
ytdl(url, { filter: format => format.qualityLabel === '720p' })
```

### T√≠ch h·ª£p v·ªõi Express.js
```js
const express = require('express');
const ytdl = require('ytdl-core');
const app = express();

app.get('/tai-video/:videoID', async (req, res) => {
  try {
    const { videoID } = req.params;
    const info = await ytdl.getInfo(videoID);
    
    res.header('Content-Disposition', `attachment; filename="${info.videoDetails.title}.mp4"`);
    ytdl(videoID, { quality: 'highest' }).pipe(res);
    
  } catch (error) {
    res.status(500).send('T·∫£i th·∫•t b·∫°i');
  }
});
```

### T·∫£i nhi·ªÅu video
```js
const videos = [
  'https://youtu.be/dQw4w9WgXcQ',
  'https://youtu.be/9bZkp7q19f0'
];

for (const url of videos) {
  const info = await ytdl.getInfo(url);
  const filename = info.videoDetails.title.replace(/[^\w\s]/gi, '') + '.mp4';
  
  ytdl(url, { quality: 'highest' })
    .pipe(fs.createWriteStream(filename));
}
```

## üìä API ch√≠nh

### ytdl(url, [options])
T·∫£i video t·ª´ URL YouTube v√† tr·∫£ v·ªÅ readable stream.

### ytdl.getInfo(url, [options])  
L·∫•y th√¥ng tin video m√† kh√¥ng t·∫£i v·ªÅ.

### ytdl.getBasicInfo(url, [options])
L·∫•y th√¥ng tin c∆° b·∫£n (nhanh h∆°n).

### ytdl.chooseFormat(formats, options)
Ch·ªçn format t·ªët nh·∫•t t·ª´ c√°c format c√≥ s·∫µn.

## üöÄ M·∫πo t·ªëi ∆∞u hi·ªáu su·∫•t

1. **S·ª≠ d·ª•ng Ch·∫ø ƒë·ªô Nhanh** (m·∫∑c ƒë·ªãnh): C·∫£i thi·ªán 17% t·ªëc ƒë·ªô
2. **Connection Pooling**: T√°i s·ª≠ d·ª•ng k·∫øt n·ªëi HTTP ƒë·ªÉ hi·ªáu su·∫•t t·ªët h∆°n
3. **Ch·ªçn Ch·∫•t L∆∞·ª£ng Ph√π H·ª£p**: Ch·∫•t l∆∞·ª£ng th·∫•p h∆°n = t·∫£i nhanh h∆°n
4. **D√πng `getBasicInfo()`**: Nhanh h∆°n `getInfo()` cho th√¥ng tin c∆° b·∫£n

## üêõ X·ª≠ l√Ω l·ªói

```js
const stream = ytdl(url);

stream.on('error', (error) => {
  if (error.statusCode === 410) {
    console.log('Video b·ªã gi·ªõi h·∫°n ƒë·ªô tu·ªïi ho·∫∑c kh√¥ng kh·∫£ d·ª•ng');
  } else {
    console.log('L·ªói t·∫£i video:', error.message);
  }
});
```

## üì± H·∫°n ch·∫ø

- Video ri√™ng t∆∞ c·∫ßn x√°c th·ª±c
- Video gi·ªõi h·∫°n ƒë·ªô tu·ªïi c√≥ th·ªÉ c·∫ßn x·ª≠ l√Ω th√™m
- Live stream c√≥ √≠t l·ª±a ch·ªçn format h∆°n
- M·ªôt s·ªë video c√≥ th·ªÉ b·ªã ch·∫∑n theo v√πng ƒë·ªãa l√Ω

## ü§ù ƒê√≥ng g√≥p

Ch√∫ng t√¥i hoan ngh√™nh c√°c ƒë√≥ng g√≥p! Vui l√≤ng ƒë·ªçc h∆∞·ªõng d·∫´n ƒë√≥ng g√≥p v√† g·ª≠i pull request.

## üìÑ Gi·∫•y ph√©p

Gi·∫•y ph√©p MIT - xem file LICENSE ƒë·ªÉ bi·∫øt chi ti·∫øt.

---

**Original Author:** fent  
**Enhanced by:** Satoru FX  
**Version:** 4.12.0  
**Performance:** +17% speed boost with Android client optimization